## 1. 문서 개요

### 1.1 목적
본 문서는 K-SectorRadar 프로젝트의 기술 스택 선정, 시스템 아키텍처 설계, 개발 환경 구성을 정의하여 시스템 개발의 기준을 제시한다.

### 1.2 범위
본 문서는 프론트엔드, 백엔드, 데이터베이스, 인프라 등의 기술 스택과 전체 시스템 아키텍처를 포함한다.

---

## 2. 기술 스택

### 2.1 프론트엔드

#### 2.1.1 프레임워크/라이브러리
- **React**: UI 프레임워크
  - 버전: 18.x 이상
  - 선택 이유: 컴포넌트 기반 개발, 풍부한 생태계, 높은 생산성

- **TypeScript**: 타입 안정성
  - 버전: 5.x 이상
  - 선택 이유: 타입 안정성, 개발 생산성 향상, 런타임 에러 방지

#### 2.1.2 상태 관리
- **React Query (TanStack Query)**: 서버 상태 관리
  - 버전: 5.x 이상
  - 선택 이유: 캐싱, 자동 리프레시, 에러 처리, 로딩 상태 관리

- **Zustand** 또는 **Context API**: 클라이언트 상태 관리
  - 선택 이유: 간단한 상태 관리, 가벼움, 학습 곡선 낮음

#### 2.1.3 라우팅
- **React Router**: 클라이언트 사이드 라우팅
  - 버전: 6.x 이상
  - 선택 이유: 표준 라우팅 솔루션, 넓은 커뮤니티 지원

#### 2.1.4 UI 라이브러리
- **Tailwind CSS**: 유틸리티 기반 CSS
  - 버전: 3.x 이상
  - 선택 이유: 빠른 개발, 커스터마이징 용이, 일관된 디자인 시스템

- **Recharts** 또는 **Chart.js**: 차트 라이브러리
  - 선택 이유: React 친화적, 다양한 차트 타입, 반응형 지원

#### 2.1.5 빌드 도구
- **Vite**: 빌드 도구
  - 버전: 5.x 이상
  - 선택 이유: 빠른 개발 서버, 최적화된 빌드, HMR 지원

### 2.2 백엔드

#### 2.2.1 프레임워크
- **Python FastAPI**: API 서버
  - 버전: 0.104.x 이상
  - 선택 이유: 빠른 성능, 자동 API 문서화, 비동기 지원, 타입 힌팅

#### 2.2.2 데이터 수집
- **BeautifulSoup4**: HTML 파싱
  - 버전: 4.12.x 이상
  - 선택 이유: 간단한 웹 스크래핑, 직관적인 API

- **Selenium** (선택적): 동적 웹 페이지 처리
  - 버전: 4.x 이상
  - 선택 이유: JavaScript 렌더링 필요 시 사용

- **Requests**: HTTP 클라이언트
  - 버전: 2.31.x 이상
  - 선택 이유: 간단한 API 호출, 널리 사용되는 라이브러리

#### 2.2.3 스케줄링
- **APScheduler**: 작업 스케줄링
  - 버전: 3.10.x 이상
  - 선택 이유: 유연한 스케줄링, 백그라운드 작업, 다양한 트리거 지원

#### 2.2.4 데이터베이스 ORM
- **SQLAlchemy**: ORM
  - 버전: 2.0.x 이상
  - 선택 이유: 강력한 ORM, 다양한 DB 지원, 마이그레이션 지원

#### 2.2.5 데이터 검증
- **Pydantic**: 데이터 검증 및 설정 관리
  - 버전: 2.x 이상
  - 선택 이유: FastAPI와 통합, 타입 검증, 자동 문서화

### 2.3 데이터베이스

#### 2.3.1 관계형 데이터베이스
- **PostgreSQL** 또는 **MySQL**
  - 버전: 최신 안정 버전
  - 선택 이유: 안정성, 성능, 풍부한 기능, 확장성

#### 2.3.2 캐시
- **Redis**: 인메모리 캐시
  - 버전: 7.x 이상
  - 선택 이유: 빠른 속도, 다양한 데이터 구조, 세션 관리 지원

### 2.4 개발 도구

#### 2.4.1 버전 관리
- **Git**: 버전 관리
- **GitHub**: 코드 저장소

#### 2.4.2 패키지 관리
- **npm** 또는 **yarn**: 프론트엔드 패키지 관리
- **pip**: 백엔드 패키지 관리
- **Poetry** (선택적): Python 의존성 관리

#### 2.4.3 코드 품질
- **ESLint**: JavaScript/TypeScript 린터
- **Prettier**: 코드 포맷터
- **Black**: Python 코드 포맷터
- **Pylint**: Python 린터

#### 2.4.4 테스트
- **Jest**: 프론트엔드 테스트
- **React Testing Library**: React 컴포넌트 테스트
- **pytest**: 백엔드 테스트

---

## 3. 시스템 아키텍처

### 3.1 전체 아키텍처 개요
시스템은 3계층 아키텍처 (Presentation, Application, Data Layer)를 기반으로 하며, Frontend와 Backend가 **REST API**를 통해 통신한다.

### 3.2 전체 아키텍처 다이어그램

```
┌─────────────────────────────────────────────────────────┐
│                    Client Layer                          │
│  ┌──────────────────────────────────────────────────┐   │
│  │  React + TypeScript + Tailwind CSS               │   │
│  │  - Dashboard, Detail, Comparison, Settings      │   │
│  └──────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────┘
                          │
                    HTTP/REST API
                          │
┌─────────────────────────────────────────────────────────┐
│                   Application Layer                      │
│  ┌──────────────────────────────────────────────────┐   │
│  │  FastAPI Server                                  │   │
│  │  - REST API Endpoints                            │   │
│  │  - Business Logic                                │   │
│  │  - Data Service                                  │   │
│  └──────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────┘
                          │
        ┌─────────────────┼─────────────────┐
        │                 │                 │
┌───────▼──────┐  ┌───────▼──────┐  ┌───────▼──────┐
│   Database   │  │  Redis Cache  │  │ Data Collector│
│ (PostgreSQL)│  │               │  │  (Scheduler) │
│             │  │               │  │              │
└──────────────┘  └──────────────┘  └──────────────┘
                          │
                          │
┌─────────────────────────────────────────────────────────┐
│              External Data Sources                       │
│  ┌──────────────┐  ┌──────────────┐                    │
│  │Naver Finance │  │ Naver News   │                    │
│  └──────────────┘  └──────────────┘                    │
└─────────────────────────────────────────────────────────┘
```

### 3.3 레이어 구조

#### 3.3.1 Presentation Layer (프레젠테이션 레이어)
- 사용자 인터페이스 컴포넌트
- 라우팅 관리
- 상태 관리 (클라이언트 상태 및 서버 상태)
- API 호출
- 사용자 인터랙션 처리

#### 3.3.2 Application Layer (애플리케이션 레이어)
- 비즈니스 로직 처리
- REST API 엔드포인트 제공
- 데이터 변환 및 가공
- 요청/응답 처리
- 인증 및 권한 관리 (향후 확장)

#### 3.3.3 Data Layer (데이터 레이어)
- 데이터베이스 접근 (ORM 사용)
- 캐시 관리 (Redis)
- 외부 API 호출
- 데이터 검증 및 저장
- 스케줄링된 데이터 수집

### 3.4 프론트엔드 아키텍처

```
src/
├── components/          # 재사용 가능한 컴포넌트
│   ├── common/         # 공통 컴포넌트
│   │   ├── Header.tsx
│   │   ├── SortFilter.tsx
│   │   └── AutoRefreshToggle.tsx
│   ├── stock/          # 종목 관련 컴포넌트
│   │   └── StockCard.tsx
│   └── chart/          # 차트 컴포넌트
│       └── MiniChart.tsx
├── pages/              # 페이지 컴포넌트
│   ├── Dashboard.tsx
│   ├── Detail.tsx
│   ├── Comparison.tsx
│   └── Settings.tsx
├── hooks/              # 커스텀 훅
├── services/           # API 서비스
│   └── apiClient.ts
├── utils/              # 유틸리티 함수
│   ├── dateFormatter.ts
│   └── numberFormatter.ts
├── types/              # TypeScript 타입 정의
├── store/              # 상태 관리
└── styles/             # 스타일 파일
```

### 3.5 백엔드 아키텍처

```
backend/
├── app/
│   ├── api/            # API 라우터
│   │   ├── stocks.py
│   │   ├── prices.py
│   │   ├── trading.py
│   │   └── news.py
│   ├── models/         # 데이터 모델
│   ├── services/       # 비즈니스 로직
│   │   └── data_service.py
│   ├── collectors/     # 데이터 수집기
│   │   ├── finance.py
│   │   └── news.py
│   ├── schemas/        # Pydantic 스키마
│   └── utils/          # 유틸리티
├── database/           # DB 관련
│   ├── models.py
│   └── connection.py
├── scheduler/          # 스케줄러
│   └── tasks.py
└── main.py             # FastAPI 앱 진입점
```

---

## 4. 개발 환경 구성

### 4.1 프론트엔드 개발 환경

#### 4.1.1 필수 요구사항
- Node.js: 18.x 이상
- npm: 9.x 이상

#### 4.1.2 프로젝트 초기화
```bash
npm create vite@latest frontend -- --template react-ts
cd frontend
npm install
```

#### 4.1.3 주요 패키지 설치
```bash
npm install react-router-dom
npm install @tanstack/react-query
npm install zustand
npm install tailwindcss postcss autoprefixer
npm install recharts
```

### 4.2 백엔드 개발 환경

#### 4.2.1 필수 요구사항
- Python: 3.10 이상
- pip: 최신 버전

#### 4.2.2 가상 환경 설정
```bash
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
```

#### 4.2.3 주요 패키지 설치
```bash
pip install fastapi uvicorn
pip install sqlalchemy
pip install beautifulsoup4 requests
pip install apscheduler
pip install redis
pip install pydantic
```

### 4.3 데이터베이스 설정

#### 4.3.1 PostgreSQL 설치 및 설정
- 로컬 개발: Docker 사용 권장
- 운영 환경: 클라우드 DB 서비스 또는 자체 서버

#### 4.3.2 Redis 설치 및 설정
- 로컬 개발: Docker 사용 권장
- 운영 환경: 클라우드 캐시 서비스 또는 자체 서버

---

## 5. 배포 아키텍처

### 5.1 개발 환경
- 로컬 개발 서버
- 개발용 데이터베이스
- 개발용 캐시 서버

### 5.2 운영 환경 (권장)

#### 5.2.1 옵션 1: 클라우드 플랫폼
- **Vercel** 또는 **Netlify**: 프론트엔드 배포
- **Railway** 또는 **Render**: 백엔드 배포
- **Supabase** 또는 **PlanetScale**: 데이터베이스
- **Upstash**: Redis 캐시

#### 5.2.2 옵션 2: 자체 서버
- **Nginx**: 리버스 프록시
- **Gunicorn** 또는 **Uvicorn**: ASGI 서버
- **Docker**: 컨테이너화
- **Docker Compose**: 오케스트레이션

### 5.3 CI/CD (선택적)
- **GitHub Actions**: 자동화된 빌드 및 배포
- 테스트 자동 실행
- 자동 배포 파이프라인

---

## 6. 보안 고려사항

### 6.1 API 보안
- CORS 설정
- Rate Limiting
- 입력 데이터 검증 (Pydantic)
- SQL Injection 방지 (ORM 사용)

### 6.2 데이터 보안
- 환경 변수 관리 (.env)
- 데이터베이스 접근 제어
- HTTPS 사용
- 민감 정보 암호화

### 6.3 인증 및 권한
- 초기 버전: 인증 없음 (공개 서비스)
- 향후 확장: 사용자 인증 시스템 (JWT 등)

---

## 7. 성능 최적화

### 7.1 프론트엔드 최적화
- 코드 스플리팅
- 이미지 최적화
- 번들 크기 최적화
- React Query 캐싱 활용

### 7.2 백엔드 최적화
- 데이터베이스 쿼리 최적화
- 캐싱 전략 (Redis)
  - 실시간 데이터: 30초 캐시
  - 종목 정보: 1시간 캐시
  - 뉴스 데이터: 10분 캐시
- 비동기 처리
- 데이터베이스 인덱스 설계

---

## 8. 모니터링 및 로깅

### 8.1 로깅
- 구조화된 로깅
- 로그 레벨 관리
- API 요청/응답 로그
- 에러 로그
- 데이터 수집 로그

### 8.2 모니터링 (선택적)
- **Sentry**: 에러 모니터링
- **Prometheus** + **Grafana**: 메트릭 모니터링
- 시스템 리소스 모니터링
- API 응답 시간 모니터링
- 데이터 수집 상태 모니터링

---

## 9. 확장성 고려사항

### 9.1 수평 확장
- 무상태(Stateless) 아키텍처
- 로드 밸런싱
- 분산 캐싱

### 9.2 수직 확장
- 서버 리소스 증설
- 데이터베이스 최적화
- 데이터 파티셔닝 (필요시)

---

## 10. 에러 처리

### 10.1 에러 분류
- 클라이언트 에러 (4xx)
- 서버 에러 (5xx)
- 외부 API 에러

### 10.2 에러 응답 형식

```json
{
  "success": false,
  "error": {
    "code": "ERROR_CODE",
    "message": "에러 메시지"
  },
  "timestamp": "2025-11-13T21:23:43Z"
}
```

---

## 11. 데이터 흐름

### 11.1 데이터 수집 흐름
```
1. Data Collector 스케줄러 실행
2. 각 종목별로 외부 API 호출
3. 데이터 검증 및 변환
4. Database 저장
5. Cache 업데이트
```

### 11.2 데이터 조회 흐름
```
1. 사용자 요청
2. Frontend API 호출
3. Backend 요청 처리
4. Cache 확인
5. Cache 미스 시 Database 조회
6. 데이터 가공 및 반환
7. Frontend 렌더링
```

---
